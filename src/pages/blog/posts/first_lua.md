---
layout: "../../../layouts/BlogPostLayout.astro"
title: "–ß—Ç–æ —Ç–∞–∫–æ–µ Lua –∏ —Å —á–µ–º –µ–≥–æ –µ–¥—è—Ç"
author: "Maxim Minaev"
date: "14 Apr 2023"
draft: false
lang: ru
---

# üêâ –ß—Ç–æ —Ç–∞–∫–æ–µ Lua –∏ –ø–æ—á–µ–º—É –≤–∞–º —Å—Ç–æ–∏—Ç –µ–≥–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å

Lua ‚Äî —ç—Ç–æ –ª—ë–≥–∫–∏–π, –±—ã—Å—Ç—Ä—ã–π –∏ –≥–∏–±–∫–∏–π —Å–∫—Ä–∏–ø—Ç–æ–≤—ã–π —è–∑—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–æ—è–≤–∏–ª—Å—è –≤ 1993 –≥–æ–¥—É. –û–Ω –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ C –∏ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ –∫–∞–∫ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—ã–π —è–∑—ã–∫, –∞ –∫–∞–∫ **–≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

–ï—Å–ª–∏ –≤—ã –∏–≥—Ä–∞–ª–∏ –≤ *World of Warcraft* –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏ –∞–¥–¥–æ–Ω—ã, –≤—ã —É–∂–µ —Å—Ç–∞–ª–∫–∏–≤–∞–ª–∏—Å—å —Å Lua. Redis –∏—Å–ø–æ–ª–Ω—è–µ—Ç Lua-—Å–∫—Ä–∏–ø—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è. Nginx –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤. –í NeoVim –ø–ª–∞–≥–∏–Ω—ã —Ç–æ–∂–µ –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –Ω–∞ Lua. –ö–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è ‚Äî —è–∑—ã–∫ –Ω–µ –∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç–æ–ø–æ–≤, –Ω–æ –∫—Ä–∞–π–Ω–µ –ø–æ–ª–µ–∑–µ–Ω –∏ –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º –≤–æ –º–Ω–æ–≥–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è.

---

## üöÄ –°–∏–Ω—Ç–∞–∫—Å–∏—Å Lua: –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ

–ù–∞—á–Ω—ë–º —Å –∫–ª–∞—Å—Å–∏–∫–∏:

```lua
print("Hello, World!")
```

–°–∏–Ω—Ç–∞–∫—Å–∏—Å Lua –Ω–µ–º–Ω–æ–≥–æ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç Pascal –∏ Python: –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è `end`, —Ç–∏–ø—ã –≤—ã–≤–æ–¥—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –≤—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–æ ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–≤.

–í —è–∑—ã–∫–µ –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

- –õ–æ–∫–∞–ª—å–Ω—ã–µ –æ–±—ä—è–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `local` –∏ –∂–∏–≤—É—Ç —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ç–µ–∫—É—â–µ–≥–æ –±–ª–æ–∫–∞.
- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –û–Ω–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `_G`, –¥–æ—Å—Ç—É–ø–Ω–æ–π –∏–∑ –ª—é–±–æ–≥–æ –∫—É—Å–∫–∞ –∫–æ–¥–∞, —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –≤ —Ç–æ–π –∂–µ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä —á—É—Ç—å –±–æ–ª–µ–µ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π ‚Äî –∑–∞–¥–∞—á–∞ –∏–∑ [Advent of Code 2022, –¥–µ–Ω—å 1](https://adventofcode.com/2022/day/1):
–ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—É–º–º—É —á–∏—Å–µ–ª, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ –±–ª–æ–∫–∞–º, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–º –ø—É—Å—Ç—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏.
```lua
local max, current = 0, 0
for line in io.lines("input.txt") do
    if line == "" then
        if current > max then
            max = current
        end
        current = 0
    else
        current = current + tonumber(line)
    end
end

if current > max then
    max = current
end

print(max)
```

---

## üß© –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –≤ Lua

–í Lua –≤—Å–µ–≥–æ –≤–æ—Å–µ–º—å –±–∞–∑–æ–≤—ã—Ö —Ç–∏–ø–æ–≤:

```
number, string, boolean, nil, function, table, thread, userdata
```

### –ù–µ—Å–∫–æ–ª—å–∫–æ –Ω—é–∞–Ω—Å–æ–≤:

- `number` –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏ —Ü–µ–ª—ã–µ, –∏ –¥—Ä–æ–±–Ω—ã–µ —á–∏—Å–ª–∞.
- `string` ‚Äî –æ–±—ã—á–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, —è–≤–ª—è—é—Ç—Å—è –∏–º–º—É—Ç–∞–±–µ–ª—å–Ω—ã–º–∏.
- `nil` ‚Äî Null, Nil, None –Ω–∞–∑—ã–≤–∞–π –∫–∞–∫ —Ö–æ—á–µ—à—å.
- `function` ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞. –§—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º, –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.
- `table` ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö: –º–∞—Å—Å–∏–≤ (–∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è —Å 1), —Å–ª–æ–≤–∞—Ä—å –∏ –æ–±—ä–µ–∫—Ç ‚Äî –≤—Å—ë –≤ –æ–¥–Ω–æ–º. 
- `thread` ‚Äî –∫–æ—Ä—É—Ç–∏–Ω—ã.
- `userdata` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å C-–¥–∞–Ω–Ω—ã–º–∏.

–¢–∏–ø–∏–∑–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∏ —Å–ª–∞–±–∞—è: –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å —Ç–∏–ø –Ω–∞ –ª–µ—Ç—É, –∞ Lua —á–∞—Å—Ç–æ –ø—ã—Ç–∞–µ—Ç—Å—è ¬´—É–≥–∞–¥–∞—Ç—å¬ª –≤–∞—à—É –∑–∞–¥—É–º–∫—É. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å—Ç—Ä–æ–∫—É "42" –º–æ–∂–Ω–æ –Ω–µ—è–≤–Ω–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ —á–∏—Å–ª–æ.

---

## üîå –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ—Å—Ç—å: –≥–ª–∞–≤–Ω–∞—è —Å–∏–ª–∞ Lua

Lua —É–¥–æ–±–Ω–æ –≤—Å—Ç—Ä–æ–∏—Ç—å –≤ –ª—é–±—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ C –∏–ª–∏ –¥–∞–∂–µ Go. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç [–ø—Ä–æ—Å—Ç–æ–π C API](https://www.lua.org/pil/24.html), —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–∫—Ä–∏–ø—Ç—ã, –æ–±–º–µ–Ω–∏–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏ –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —è–∑—ã–∫ –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏.

### –ü—Ä–∏–º–µ—Ä: –∫–∞–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç—å Lua-—Å–∫—Ä–∏–ø—Ç –∏–∑ Go

Lua-—Ñ–∞–π–ª `fib5.lua`:

```lua
function fib(n)
    local fib = {1, 1} 
    for i = 3,n,1 do
        fib[#fib+1] = fib[#fib] + fib[#fib-1]
    end
    return fib[n]
end
return fib(5)
```

–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ Go:

–Ø –±—É–¥—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç [github.com/yuin/gopher-lua](https://github.com/yuin/gopher-lua) –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, –Ω–æ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –∏ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –ø–æ–º–æ—â—å—é CGO.

```go
package main

import (
	"fmt"

	lua "github.com/yuin/gopher-lua"
)

func main() {
	var l *lua.LState = lua.NewState()
	defer l.Close()
	if err := l.DoFile("fib5.lua"); err != nil {
		panic(err)
	}

	// –¥–æ—Å—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –≤–µ—Ä—à–∏–Ω—ã —Å—Ç—ç–∫–∞
	result := l.Get(-1)
	// –∏ –æ—á–∏—â–∞–µ–º –µ–≥–æ
	l.Pop(1)
	fmt.Printf("result: %d\n", result) // result: 5
}
```

E—Å–ª–∏ –º—ã –∑–∞—Ö–æ—Ç–∏–º –∑–∞–Ω–æ–≤–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç, —Ç–æ –Ω–∞–º –Ω–µ –Ω–∞–¥–æ –∑–∞–Ω–æ–≤–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–π–ª, —Ñ—É–Ω–∫—Ü–∏—è fib(n) —É–∂–µ –ª–µ–∂–∏—Ç –≤ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞—à–µ–≥–æ l *lua.LState. –ù—É–∂–Ω–æ –ª–∏—à—å –¥–æ—Å—Ç–∞—Ç—å –µ—ë, –∏ –ø–æ–ª–æ–∂–∏—Ç—å –Ω–∞ —Å—Ç–µ–∫ –≤–º–µ—Å—Ç–µ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, –∞ –∑–∞—Ç–µ–º –≤—ã–∑—ã–≤—Ç—å l.Call(nargs, nret).

```go
...
//—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –Ω–∞ —Å—Ç—ç–∫ —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
l.Push(l.GetGlobal("fib")) // stack: function "fib"
//—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –Ω–∞ —Å—Ç—ç–∫ –∞—Ä–≥—É–º–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏
l.Push(lua.LNumber(15))    // stack: function "fib", 15
// l.Call –∑–∞–±–∏—Ä–∞–µ—Ç –∏–∑ —Å—Ç—ç–∫–∞ —Ñ—É–Ω–∫—Ü–∏—é –∏ 1 –∞—Ä–≥—É–º–µ–Ω—Ç, –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ 1 —Ä–µ–∑—É–ª—å—Ç–∞—Ç
l.Call(1, 1)               // stack: 610
result = l.Get(-1)         // stack: 610
l.Pop(1)                   // stack:
fmt.Printf("result: %d\n", result) //result: 610
```
---

## üåê –ì–¥–µ Lua —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

Lua –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö:

- **World of Warcraft** ‚Äî –∞–¥–¥–æ–Ω—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
- **Redis** ‚Äî –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö.
- **Nginx** ‚Äî –º–æ–¥—É–ª—å `ngx_http_lua_module`.
- **NeoVim** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π API –¥–ª—è –ø–ª–∞–≥–∏–Ω–æ–≤.
- **–ò–≥—Ä–æ–≤—ã–µ –¥–≤–∏–∂–∫–∏** ‚Äî Defold, Pico-8, Love2D –∏ –¥—Ä—É–≥–∏–µ.

---

## üß™ –ó–∞—á–µ–º —É—á–∏—Ç—å Lua –≤ 2025 –≥–æ–¥—É?

Lua ‚Äî –Ω–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —è–∑—ã–∫ –Ω–∞ –≤—Å–µ —Å–ª—É—á–∞–∏ –∂–∏–∑–Ω–∏. –ù–æ –µ—Å–ª–∏ –≤—ã:

- –ø–∏—à–µ—Ç–µ backend –Ω–∞ Nginx –∏–ª–∏ Redis,
- —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å NeoVim –∏ —Ö–æ—Ç–∏—Ç–µ –¥–µ–ª–∞—Ç—å –ø–ª–∞–≥–∏–Ω—ã,
- –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—Å—Ç—Ä–æ–∏—Ç—å —Å–∫—Ä–∏–ø—Ç–æ–≤—ã–π —è–∑—ã–∫ –≤ —Å–≤–æ—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ,

...—Ç–æ Lua ‚Äî —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –û–Ω –º–∞–ª–µ–Ω—å–∫–∏–π, –±—ã—Å—Ç—Ä—ã–π –∏ –≥–∏–±–∫–∏–π. –ò –∫ —Ç–æ–º—É –∂–µ ‚Äî –ø—Ä–∏—è—Ç–Ω–æ —É–¥–∏–≤–ª—è–µ—Ç —Å–≤–æ–µ–π –ª–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å—é.

